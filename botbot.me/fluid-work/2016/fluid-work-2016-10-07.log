b'2016-10-07T18:23:37 * alanharnum joined the channel
2016-10-07T18:27:05 <michelled> jhernandez: do you know the status of the snapsets? have they been decided on?
2016-10-07T18:30:05 <avtar> gtirloni: i\'m going to grab lunch and then give it a shot once i get to the office
2016-10-07T18:30:15 <gtirloni> avtar: thanks!!
2016-10-07T18:44:46 * clown has quit
2016-10-07T18:50:18 <jhernandez> michelled: I don\'t think so, IIRC Sandra was going to ask UX to clarify/define them
2016-10-07T18:51:25 <michelled> ah ok, thx jhernandez
2016-10-07T18:52:45 <jhernandez> michelled: so far, I think https://docs.google.com/document/d/1hRH3XfZiHBeiwQdkVrfLgNWZRJCWl_JHA8Ely02g1xQ/edit is what he already have
2016-10-07T18:52:58 <jhernandez> *s/he/we
2016-10-07T18:55:06 <jhernandez> the thing is that the snapsets include stuff that we don\'t support yet
2016-10-07T18:56:10 <jhernandez> so I guess that is a matter of using those that we can support in the short-mid term for this first iteration
2016-10-07T18:56:44 <jhernandez> but they are good in terms of "what we would like to support by the end of APCP"
2016-10-07T18:59:02 * -- BotBot disconnected, possible missing messages --
2016-10-07T18:59:02 * -- BotBot disconnected, possible missing messages --
2016-10-07T19:01:06 * [o__o] joined the channel
2016-10-07T19:01:06 <jhernandez> michelled: I gotta leave, the kitchen awaits me .... today I\'m going for an italian foccaccia and I haven\'t started with the dough
2016-10-07T19:01:06 <jhernandez> :)
2016-10-07T19:01:13 <jhernandez> cheers
2016-10-07T19:01:23 <michelled> nice! sounds great
2016-10-07T19:01:43 <michelled> jhernandez: I\'ve started up some sourdough starter so I\'m baking regularly again :)
2016-10-07T19:01:47 <michelled> have a good dinner
2016-10-07T19:08:47 * amatas has quit
2016-10-07T19:08:47 * simonjb has quit
2016-10-07T19:08:47 * ewbjr has quit
2016-10-07T19:08:47 * stegru has quit
2016-10-07T19:09:04 * amatas joined the channel
2016-10-07T19:09:06 * simonjb joined the channel
2016-10-07T19:09:06 * simonjb has quit
2016-10-07T19:09:06 * simonjb joined the channel
2016-10-07T19:09:12 * stegru joined the channel
2016-10-07T19:09:29 * clown joined the channel
2016-10-07T19:13:17 * ewbjr joined the channel
2016-10-07T19:13:53 * clown has quit
2016-10-07T19:14:16 * clown joined the channel
2016-10-07T19:18:57 * kasparnet has quit
2016-10-07T19:18:57 * the-t-in-rtf has quit
2016-10-07T19:19:15 * the-t-in-rtf joined the channel
2016-10-07T19:19:17 * colinclark joined the channel
2016-10-07T19:19:22 * gtirloni joined the channel
2016-10-07T19:19:30 * kasparnet joined the channel
2016-10-07T19:21:10 * clown joined the channel
2016-10-07T19:21:50 * clown joined the channel
2016-10-07T19:33:24 * Bosmon has quit
2016-10-07T19:33:43 * colinclark joined the channel
2016-10-07T19:33:54 * Jess_ joined the channel
2016-10-07T19:40:50 * Bosmon joined the channel
2016-10-07T19:47:41 * cindyli has quit
2016-10-07T19:47:42 * Bosmon7 has quit
2016-10-07T19:47:49 * scott_gonzalez has quit
2016-10-07T19:47:51 * gloob has quit
2016-10-07T19:47:54 * gloob_ joined the channel
2016-10-07T19:48:17 * Bosmon7 joined the channel
2016-10-07T19:48:21 * cindyli joined the channel
2016-10-07T19:49:20 * scott_gonzalez joined the channel
2016-10-07T19:50:20 * avtar has quit
2016-10-07T19:57:27 * alanharnum joined the channel
2016-10-07T20:09:35 * simonjb has quit
2016-10-07T20:09:43 * simonjb joined the channel
2016-10-07T20:11:13 * lliskovoi_ joined the channel
2016-10-07T20:14:29 * lliskovoi has quit
2016-10-07T20:15:25 * clown joined the channel
2016-10-07T20:28:52 * alanharnum joined the channel
2016-10-07T20:31:13 * simonjb has quit
2016-10-07T20:31:13 * simonjb joined the channel
2016-10-07T20:31:17 * clown joined the channel
2016-10-07T20:31:28 * alanharnum joined the channel
2016-10-07T20:33:57 * stegru has quit
2016-10-07T20:34:08 * cindyli has quit
2016-10-07T20:34:23 * ewbjr has quit
2016-10-07T20:34:40 * gloob_ has quit
2016-10-07T20:35:00 * Bosmon7 has quit
2016-10-07T20:35:05 * kasparnet has quit
2016-10-07T20:35:27 * simonjb joined the channel
2016-10-07T20:38:46 * alanharnum joined the channel
2016-10-07T20:38:46 * clown joined the channel
2016-10-07T20:38:46 * gloob_ joined the channel
2016-10-07T20:38:46 * Bosmon joined the channel
2016-10-07T20:38:46 * amatas joined the channel
2016-10-07T20:39:14 * cindyli joined the channel
2016-10-07T20:39:15 * ewbjr joined the channel
2016-10-07T20:39:36 * colinclark joined the channel
2016-10-07T20:39:36 * stegru joined the channel
2016-10-07T20:39:55 * Bosmon7 joined the channel
2016-10-07T20:39:55 * kasparnet joined the channel
2016-10-07T20:40:25 <cindyli> Bosmon7: i don\'t have push access to gpii/nexus repo. can you merge simonjb\'s this pull request when you have a chance: https://github.com/GPII/nexus/pull/6
2016-10-07T20:40:57 <cindyli> i added a comment of "ready to be merged"
2016-10-07T20:45:34 * alanharn_ joined the channel
2016-10-07T20:54:03 * cindyli1 joined the channel
2016-10-07T21:17:13 * avtar joined the channel
2016-10-07T21:28:32 <Bosmon7> Thanks, cindyli1 - will do
2016-10-07T21:28:42 <cindyli1> thanks, Bosmon7
2016-10-07T21:48:12 * kasparnet has quit
2016-10-07T21:57:23 * kasparnet joined the channel
2016-10-07T22:02:16 * kasparnet has quit
2016-10-07T22:26:10 * avtar joined the channel
2016-10-07T22:54:04 * stegru has quit
2016-10-07T22:56:10 * simonjb has quit
2016-10-07T22:58:53 * kasparnet joined the channel
2016-10-07T22:59:53 * alanharnum joined the channel
2016-10-07T23:02:57 * kasparnet has quit
2016-10-07T23:32:00 * avtar joined the channel
'

b'2016-10-07T15:45:13 <Bosmon7> But to me, gio\'s changes should have the opposite effect than the one you\'re describing
2016-10-07T15:45:26 <Bosmon7> That is, they should make it less likely for the contents of node_modules to conflict, not more
2016-10-07T15:45:42 <Bosmon7> Well
2016-10-07T15:45:56 <Bosmon7> I guess what\'s really happening is that gio\'s changes are saving us from a problem we hadn\'t run in to yet
2016-10-07T15:46:25 * kasparnet joined the channel
2016-10-07T15:46:36 <Bosmon7> It would seem that we have quite a different approach to running the tests for universal than the ones for windows
2016-10-07T15:46:44 <Bosmon7> if we don\'t use "grunt tests" on windows, what do we use?
2016-10-07T15:47:28 <Bosmon7> Well, to me it seems that we just run the tests manually on Windows?
2016-10-07T15:47:41 <Bosmon7> In the windows readme I see instructions listing commands to be run inside the VM
2016-10-07T15:47:48 <Bosmon7> Is this historically as well as we could do?
2016-10-07T15:47:52 <Bosmon7> And if so, what does the CI do?
2016-10-07T15:48:57 <avtar> we didn\'t in the past since we couldn\'t trigger commands in the windows vm from the outside world, with the exception of in hosted ci where we used jenkins to run commands in the vm. linux allowed us to remotely run commands that require a desktop environment so grunt is used there https://github.com/GPII/linux/blob/master/Gruntfile.js#L123-L134
2016-10-07T15:49:50 <avtar> now we can run tests remotely for windows as well https://github.com/idi-ops/packer-windows#run-commands so grunt tasks (or npm scripts) could be used for that project
2016-10-07T15:49:58 <Bosmon7> avtar - so how does the CI run the windows tests?
2016-10-07T15:50:59 <Bosmon7> Ah
2016-10-07T15:50:59 <avtar> Bosmon7: remotely using winrm https://github.com/GPII/ci-service/blob/master/jenkins_jobs/windows.yml#L59
2016-10-07T15:51:58 <Bosmon7> Ok
2016-10-07T15:52:03 * kasparnet has quit
2016-10-07T15:52:10 <Bosmon7> Well the use of npm scripts would still require npm install to run on the host
2016-10-07T15:52:18 <Bosmon7> Which would have required Gio\'s changes anyway, I think
2016-10-07T15:52:23 * alanharn_ joined the channel
2016-10-07T15:52:29 <Bosmon7> Since as soon as we run npm install on the host outside Windows, we are hosed
2016-10-07T15:53:30 <avtar> yup
2016-10-07T15:53:39 <stegru> So is "grint tests" the only reason to run "npm install" in the host?
2016-10-07T15:53:44 <stegru> grunt
2016-10-07T15:53:53 * stegru grunts
2016-10-07T15:53:55 <avtar> stegru: yes
2016-10-07T15:54:06 <stegru> ok.
2016-10-07T15:54:15 <Bosmon7> In theory we should just have a tiny module that only takes care of the tests
2016-10-07T15:54:35 <stegru> from what I can see in the gruntfile, the actual tests are ran in the VM
2016-10-07T15:54:40 <Bosmon7> Yes
2016-10-07T15:55:04 <Bosmon7> avtar - don\'t we have a big problem? In that this approach seems to force us to have the host OS matching the one inside the VM
2016-10-07T15:55:06 <stegru> ok
2016-10-07T15:55:14 <Bosmon7> Surely "npm install" run on the windows repository on a linux host will fail
2016-10-07T15:56:08 <Bosmon7> And depending on which variety of npm it is, it will blow away some or all of the things that were part of the failed install
2016-10-07T15:56:09 * alanharn_ has quit
2016-10-07T15:57:29 * gtirloni has quit
2016-10-07T15:57:36 <avtar> Bosmon7: one sec
2016-10-07T15:57:36 <stegru> why would you do that? if the windows repository doesn\'t have a "grunt tests"?
2016-10-07T15:57:45 <Bosmon7> stegru - it doesn\'t have one currently
2016-10-07T15:57:57 <Bosmon7> But I\'d imagine we want to move over to some kind of consistent structure for all of our projects
2016-10-07T15:58:05 <Bosmon7> And from what avtar is telling is, we now "could"
2016-10-07T15:58:06 <stegru> yes, got it now
2016-10-07T15:58:29 <Bosmon7> We especially want to move over to a consistent structure if we are going for a monorepo with every architecture piled into the same tree
2016-10-07T16:00:15 * alanharn_ joined the channel
2016-10-07T16:06:41 <stegru> by the way, I run "grunt lint" in the windows repository (that\'s been npm install-ed in windows), on a linux host
2016-10-07T16:14:06 * alanharn_ has quit
2016-10-07T16:15:21 <avtar> Bosmon7: back
2016-10-07T16:15:31 <avtar> https://issues.gpii.net/browse/GPII-2060
2016-10-07T16:15:52 <avtar> that is the solution gio was discussing earlier
2016-10-07T16:17:24 <Bosmon7> avtar - it\'s reasonable as far as it goes
2016-10-07T16:17:44 <Bosmon7> But how, in general, do we plan to run "npm install" on a host which may mismatch the module content that we are trying to install?
2016-10-07T16:17:46 <avtar> it\'s still being tested but hopefully the result will be the host and vm keeping their own separate instances of node_modules
2016-10-07T16:18:38 <Bosmon7> avtar ^
2016-10-07T16:24:03 <avtar> Bosmon7: the idea is to separate the host\'s node_modules directory from the guest\'s so that commands can be run on either side but preventing changes from being synced between the two operating systems
2016-10-07T16:24:10 <avtar> whether that will work is still being tested
2016-10-07T16:25:41 <Bosmon7> avtar, yes, I understand that
2016-10-07T16:26:08 <Bosmon7> I\'m trying to put my finger on a problem that we, to a certain extent, have always had, but will now become more obvious
2016-10-07T16:26:50 <Bosmon7> Which is that it is incorrect to run npm install on the host, since this implies that the host is capable of building the entire project in question
2016-10-07T16:26:53 <Bosmon7> This will not be true in general
2016-10-07T16:27:00 <Bosmon7> Does that make sense?
2016-10-07T16:27:35 <avtar> yes
2016-10-07T16:29:09 <Bosmon7> My sense is that if we are running "npm install" on the host purely for the purpose of running some scripts within the VM, this should be done on some smaller, specialised project within the tree
2016-10-07T16:29:12 <Bosmon7> That only has that purpose
2016-10-07T16:29:26 <Bosmon7> And if we do that, the whole problem of having conflicting node_modules between the host and client will go away
2016-10-07T16:29:39 <Bosmon7> Since there will no longer be any modules in conflict
2016-10-07T16:30:06 <Bosmon7> There will then be no need to experiment with esoteric technologies such as "JUNCTION POINTS" etc.
2016-10-07T16:30:26 <Bosmon7> Does that make sense?
2016-10-07T16:32:04 <avtar> it seems people have run into conflicting node_modules between hosts and vms even when the modules aren\'t being used to facilitate execution of scripts
2016-10-07T16:32:30 <Bosmon7> It\'s true, if they run npm install on the host, they will conflict anyway
2016-10-07T16:37:16 * kasparnet joined the channel
2016-10-07T16:38:01 * cindyli joined the channel
2016-10-07T16:40:25 <avtar> Bosmon7: so if this new bind mount approach doesn\'t work we\'re back to just requiring everyone to not run npm install on hosts or at least removing node_modules before starting a vm
2016-10-07T16:40:39 <Bosmon7> avtar - I guess we need to pursue both angles at once
2016-10-07T16:40:43 <avtar> although what started all this was the npm3 issue that cindyli encountered
2016-10-07T16:41:05 <Bosmon7> That is, i) not sharing node_modules, ii) using a separate project to host the scripts which run the VM tests
2016-10-07T16:53:01 * kasparnet has quit
2016-10-07T17:01:51 * alanharnum joined the channel
2016-10-07T17:02:22 <cindyli> avtar, seems i cannot deploy https://guide.inclusivedesign.ca/ cuz i don\'t have privilege on https://github.com/inclusive-design/guide.inclusivedesign.ca. do you know who has privilege on that site? the guide site is ready to be deployed
2016-10-07T17:04:04 * lliskovoi joined the channel
2016-10-07T17:04:22 <avtar> cindyli: i think most of the idrcers are listed as owners for that github org
2016-10-07T17:05:26 <cindyli> Justin_o: r u there?
2016-10-07T17:05:47 <avtar> i just sent you an invitation
2016-10-07T17:05:56 <cindyli> ah cool. thanks, avtar
2016-10-07T17:07:10 * alanharnum has quit
2016-10-07T17:10:29 * alanharnum joined the channel
2016-10-07T17:13:55 * gtirloni joined the channel
2016-10-07T17:21:58 <gtirloni> re: the previous discussion about grunt tasks, if we were using npm scripts exclusively, then `npm install` on the host wouldn\'t be necessary, right? it looks like we\'re not doing much with grunt for tests, basically just aliasing some commands. in that case, going with npm scripts, would simplify things (if i got this right)
2016-10-07T17:23:34 <cindyli> avtar: still having permission problem. I\'m not yet an owner - https://github.com/orgs/inclusive-design/teams/owners
2016-10-07T17:24:36 <avtar> cindyli: could you try now?
2016-10-07T17:24:42 <cindyli> sure
2016-10-07T17:26:20 * alanharnum has quit
2016-10-07T17:26:50 <cindyli> works perfectly, thanks, avtar
2016-10-07T17:26:58 <avtar> awesome :)
2016-10-07T17:27:31 * alanharnum joined the channel
2016-10-07T17:29:33 * kasparnet joined the channel
2016-10-07T17:29:58 <avtar> cindyli: i was trying your GPII-1274 universal branch with gtirloni\'s GPII-2060 changes
2016-10-07T17:30:22 <avtar> removing node_modules from the host also removes it from the guest
2016-10-07T17:30:37 <gtirloni> with windows?
2016-10-07T17:30:44 <avtar> yup
2016-10-07T17:30:50 <avtar> windows 10 host
2016-10-07T17:31:01 <gtirloni> ah yeah, i haven\'t changed anything in GPII/windows yet.. just changed the ansible role that is used for linux
2016-10-07T17:31:25 <avtar> no, i meant windows 10 host with the universal fedora 24 vm
2016-10-07T17:32:05 <gtirloni> hmm interesting. so deleting node_modules from the host.. breaks the bind mount inside linux?
2016-10-07T17:32:19 <avtar> seems like it
2016-10-07T17:32:37 <avtar> and then running npm install in the vm created a node_modules directory on the host
2016-10-07T17:33:08 <avtar> this is the branch i\'m using https://github.com/cindyli/universal/tree/GPII-1274
2016-10-07T17:34:26 <avtar> although that second process did not finish successfully
2016-10-07T17:35:30 <avtar> https://www.pastery.net/hfmdak/
2016-10-07T17:36:19 <gtirloni> once the bind mount is broken, we\'re back to shared folder issues
2016-10-07T17:36:50 <gtirloni> if you run `vagrant reload` after deleting the node_modules on the host, it should bring the bind mount back
2016-10-07T17:40:19 <cindyli> *sighhh..*
2016-10-07T17:41:07 <avtar> gtirloni: once i do that and run \'npm install\' on the host should i expect node_modules to be created in the vm?
2016-10-07T17:41:36 <avtar> because that\'s what i end up with here :/
2016-10-07T17:42:31 <gtirloni> it seems i was wrongly assuming the app\'s node_modules dir would already be created. i can fix it by ensuring it\'s created always before attempting the bind mount
2016-10-07T17:42:49 <avtar> ok
2016-10-07T17:42:54 <gtirloni> one sec
2016-10-07T18:00:56 <cindyli> avtar: i found the deployment of https://guide.inclusivedesign.ca/ only uploads the docpad output html without triggering "npm install". do we need to manually trigger "npm install" on the server?
2016-10-07T18:01:51 <gtirloni> cindyli: it runs npm install, then docpad.. and transfer the results. https://github.com/inclusive-design/ci-service/blob/master/jenkins_jobs/website-guide.inclusivedesign.ca.yml#L14
2016-10-07T18:02:56 <cindyli> this link gives 404
2016-10-07T18:03:52 <gtirloni> cindyli: it\'ll only deploy the guide if there is a commit
2016-10-07T18:03:55 <cindyli> is there a way i can check one node module gets updated?
2016-10-07T18:04:02 <Bosmon7> gtirloni - even if we use npm scripts, we still need something installed
2016-10-07T18:04:14 <Bosmon7> I guess, unless the scripts only use node built-in APIs
2016-10-07T18:04:15 <cindyli> ah ha, what if i only wanna run "npm install"?
2016-10-07T18:04:52 <gtirloni> Bosmon7: ah, that\'s what i was missing, makes sense. in the case of triggering the tests, we are running some simple commands (`vagrant ssh -c ...`) but i can see how other more complex tasks could require it
2016-10-07T18:05:17 <gtirloni> cindyli: i don\'t think i understand.. `npm install` alone will create the html output that will be deployed?
2016-10-07T18:05:51 <cindyli> nah, gtirloni, the script of a node module has been changed and i wanna pull in that change for the guide site
2016-10-07T18:06:26 <cindyli> gtirloni: the node dependence is https://github.com/fluid-project/docs-core/
2016-10-07T18:07:01 <cindyli> the html doesn\'t need to be touched at all
2016-10-07T18:08:09 <gtirloni> what are you trying to accomplish? i still don\'t get it, sorry. if docs-core was updated, the initial npm install would pick that up. do you want to run `npm install` right now on the temporary folder that got created for the last build (23 days ago)?
2016-10-07T18:08:13 * colinclark joined the channel
2016-10-07T18:08:38 <gtirloni> jenkins fetchs the guide\'s repo, runs npm install, then docpad.. once it\'s done, only html is transferred to the destination server
2016-10-07T18:09:01 <gtirloni> so if you commit your changes, it\'ll trigger a deploy
2016-10-07T18:10:16 <cindyli> yes, i need to make a commit to https://github.com/inclusive-design/guide.inclusivedesign.ca to trigger the deployment process, which I don\'t want need since there\'s nothing changed in that repo.
2016-10-07T18:10:28 <cindyli> that\'s probably why the deployment process wasn\'t triggered at all
2016-10-07T18:10:43 <cindyli> and results in the "npm install" didn\'t get run
2016-10-07T18:11:11 <gtirloni> ok, understood. i will trigger a new build manually for you from here: https://ci.inclusivedesign.ca/
2016-10-07T18:11:11 <cindyli> so the new commit for https://github.com/fluid-project/docs-core/ is not pulled into node_modules/
2016-10-07T18:11:22 <cindyli> thanks a lot, gtirloni
2016-10-07T18:11:57 <Bosmon7> gtirloni - ok - if we can trigger the VM tests just by using builtins, that would be brilliant
2016-10-07T18:12:58 * alanharnum has quit
2016-10-07T18:13:19 <gtirloni> cindyli: it\'s done (https://ci.inclusivedesign.ca/job/website-guide.inclusivedesign.ca/15/console). in the future it might be good to commit to a changelog was something, so there is a reference a deployment is being done for $x reason (might help in troubleshooting)
2016-10-07T18:13:48 <cindyli> good point. thanks, gtirloni
2016-10-07T18:14:50 <gtirloni> yw
2016-10-07T18:16:06 <gtirloni> avtar: i think deleting the host\'s node_modules is the weak point in the split node_modules solution
2016-10-07T18:16:18 <gtirloni> avtar: i was wrong.. `vagrant reload` won\'t fix it. it has to be `vagrant provision`
2016-10-07T18:17:14 <gtirloni> avtar: `vagrant provision` will reestablish the bind mount
2016-10-07T18:17:41 <gtirloni> luckily it\'s pretty fast, since all packages are already installed
2016-10-07T18:21:34 * kavya has quit
'

b'2016-10-07T00:01:50 * cindyli joined the channel
2016-10-07T03:26:43 * UserUltimate joined the channel
2016-10-07T03:26:52 * UserUltimate has quit
2016-10-07T06:11:33 * amatas joined the channel
2016-10-07T06:21:43 * kasparnet joined the channel
2016-10-07T06:47:31 * kasparnet has quit
2016-10-07T06:58:30 * the-t-in-rtf joined the channel
2016-10-07T07:39:33 * stegru joined the channel
2016-10-07T11:08:34 * kasparnet joined the channel
2016-10-07T11:28:15 * Justin_o joined the channel
2016-10-07T11:52:09 * alanharnum joined the channel
2016-10-07T12:04:11 * kasparnet has quit
2016-10-07T12:06:39 * kasparnet joined the channel
2016-10-07T12:14:50 * gtirloni joined the channel
2016-10-07T12:29:56 * alanharnum joined the channel
2016-10-07T12:33:31 * cindyli joined the channel
2016-10-07T12:38:08 * jhernandez has quit
2016-10-07T12:44:58 * jhernandez joined the channel
2016-10-07T13:01:32 * kasparnet has quit
2016-10-07T13:06:48 <cindyli> avtar: i pushed a commit to my GPII-1274 branch to fix the browserifying issue on windows. it works fine on my windows 10 vm. can you give a try when you have a chance? thanks
2016-10-07T13:28:41 * Jess_ joined the channel
2016-10-07T13:34:24 * colinclark joined the channel
2016-10-07T13:42:06 * kavya joined the channel
2016-10-07T13:52:36 <Justin_o> cindyli: could you please review this PR when you have a chance. https://github.com/fluid-project/docs-core/pull/4
2016-10-07T13:52:53 <cindyli> ok, Justin_o
2016-10-07T13:53:04 <Justin_o> you can test it against the guides site locally by using npm link. I\'ve written up some documentation on how to use npm link on the wiki https://wiki.fluidproject.org/display/fluid/NPM+Tips+and+Tricks
2016-10-07T13:53:33 <Justin_o> cindyli: thanks
2016-10-07T13:56:57 * simonjb joined the channel
2016-10-07T13:57:59 <gtirloni> fluid-everyone: regarding the proposed change to have split node_module directories between a host and a Vagrant VM to work around issues with shared folders and npm3 (shared folders doens\'t work well with symlinks on Windows, npm3 doesn\'t work well without symlinks on Linux/OSX and shared folders), do you feel it will disturb your workflow in any way? is anyone relying on the node_modules dir being sin sync between host and VM? would you
2016-10-07T13:57:59 <gtirloni> like the split node_modules functionality to be configurable for your situation?
2016-10-07T13:59:05 <Justin_o> gtirloni: what would this affect?
2016-10-07T13:59:05 <Justin_o> which projects, repos, etc.
2016-10-07T13:59:21 <gtirloni> everybody, all projects
2016-10-07T13:59:33 <gtirloni> no changes required on any repos though
2016-10-07T14:00:15 * kasparnet joined the channel
2016-10-07T14:03:38 * alanharnum joined the channel
2016-10-07T14:05:01 * kasparnet has quit
2016-10-07T14:05:06 <gtirloni> basically I would like to understand if anyone is betting on the fact that node_modules dir is synchronized between the host and the VM... and I would like to understand that workflow, have more insight into how the QI automation is being used in the real world
2016-10-07T14:05:28 <stegru> so.. node_modules will be stored on the VM?
2016-10-07T14:05:46 <Justin_o> gtirloni: would this affect using npm link?
2016-10-07T14:06:20 * michelled joined the channel
2016-10-07T14:06:27 <avtar> cindyli: i\'m trying your branch now
2016-10-07T14:06:41 <gtirloni> if you\'re running `npm link` on your host and expecting the results to show up inside the VM, yes. the node_modules inside the VM would be a separate instance, not connected to the node_modules outside the VM
2016-10-07T14:07:37 <cindyli> thanks, avtar
2016-10-07T14:08:13 <gtirloni> stegru: today when the VM starts, the node_modules you see inside the VM is the same you see outside of it. This has caused many problems with VirtualBox shared folders (thus why we don\'t use npm symlinks), developers running `npm install` on OSX/Windows and then having issues inside the Linux VM, etc. And now we identified a problem where npm3 without symlinks doesn\'t work like it should (stack exceeded error). Splitting the node_modules
2016-10-07T14:08:13 <gtirloni> directory would allow us to go back to the default behavior of having symlinks enabled
2016-10-07T14:08:50 <Justin_o> gtirloni: i\'m not sure if there are any current cases where npm link would be required for testing with someone making use of the VM, but I could see how it could be an issue when developing modules that you want to test in another project
2016-10-07T14:08:54 <avtar> gtirloni: i prefer your workaround over the one we have in place since it provides better performance and addresses the symlink issue
2016-10-07T14:09:58 <avtar> one concern comes to mind for projects that use the monorepo approach, possibly expecting \'npm install\' to be run in the root directory and then also subdirectories
2016-10-07T14:10:08 <gtirloni> Justin_o: would it be acceptable to run `npm link` inside the Linux VM while the testing is occurring? It would like require running `npm link` twice (once outside and once inside) if someone is on, say, a OSX machine and using the Linux VM
2016-10-07T14:10:29 <stegru> ok gtirloni. i don\'t like the built-in shared folder anyway, so i mount the project using NFS
2016-10-07T14:10:32 <avtar> this new approach would be fine for the first case but npm would freak out in subdirectories
2016-10-07T14:11:03 <avtar> stegru: i think we\'ll still use virtualbox shared folders :/
2016-10-07T14:11:05 <gtirloni> stegru: so in your case this behavior would have to be configurable as to not step on your usage of NFS, right?
2016-10-07T14:11:29 * stegru stratches his head
2016-10-07T14:11:31 <gtirloni> yes, we are still using vagrant shared folders because we keep everything BUT node_modules in sync
2016-10-07T14:11:35 <avtar> this just moves the node_modules directory to a location on the linux guest\'s file system
2016-10-07T14:11:57 <Justin_o> gtirloni: i don\'t think it would work to run npm link inside the VM.. when you use npm link it creates a global install on your machine locally of the project you are developing on. Then you create a link to that in the project you want to test the changes in.
2016-10-07T14:12:47 <stegru> to be honest, I don\'t care what you do. I\'ll find a way to work around it if it causes a problem for me
2016-10-07T14:12:54 <gtirloni> Justin_o: got it. in the case, does that even work today? I mean, someone installing a project globally on OSX and then going into the Linux VM to use that global installed module?
2016-10-07T14:13:13 <avtar> gtirloni: for example \'npm install\' needs to be run in ~/path/to/universal and then also in ~/path/to/universal/gpii/node_modules/preferencesServer/
2016-10-07T14:14:05 <Justin_o> gtirloni: not sure, i haven\'t tried it, but if the node_modules are kept in sync, i\'d assume it could work because that link is created on your local machine anyways and being copied over.. assuming the contents and not just the link are being copied over
2016-10-07T14:14:06 <avtar> stegru: :P
2016-10-07T14:14:10 <gtirloni> avtar: so there is a chance that nested node_modules directory would face the same issues with symlinks etc because it would be inside the shared folder?
2016-10-07T14:15:18 <avtar> gtirloni: yes, the universal example is a bit contrived since the nested gpii components aren\'t used in the fedora vm but i\'m guessing we\'ll encounter something like this in the future
2016-10-07T14:15:30 <stegru> fyi, my setup is linux host, with several windows VMs at the same time (only one of them is the standard vagrant box). i will only run gpii in a vm
2016-10-07T14:15:35 <gtirloni> Justin_o: I thinking the link created from the local node_modules dir to the global node_modules dir (on the host) wouldn\'t be understood inside the VM
2016-10-07T14:16:18 <avtar> stegru: ah i assumed you were using a windows host which made me more curious about your nfs setup
2016-10-07T14:16:21 <stegru> ..they all point to the same source code, on my host
2016-10-07T14:16:43 <stegru> ah yes, avtar - that would be strange
2016-10-07T14:16:49 <avtar> but awesome
2016-10-07T14:17:10 * lliskovoi joined the channel
2016-10-07T14:19:38 * gtirloni is afraid to ask if anyone is actually using the vagrant automation
2016-10-07T14:21:18 <jhernandez> hey guys, just read this discussion
2016-10-07T14:21:20 <gtirloni> there two pieces in this puzzles that are partially broken: virtualbox shared folders and npm3. For the first we need filesystem/kernel/C/C++ knowledge to fix ourselves. For the latter, npm3 has been having these stack exceeded issues for a long time and they seem to pop up from time to time
2016-10-07T14:21:37 <jhernandez> I\'m with stegru, I\'ll be fine with whatever you feel is better, I always end up accomodating myself to what I get
2016-10-07T14:22:38 <gtirloni> thanks javi/stegru, that\'s nice to know :)
2016-10-07T14:23:06 <jhernandez> gtirloni: I am using the vagrant automation for windows, for universal I keep using my own system until I reach a point where I have to submit a pull request, then I use our universal box
2016-10-07T14:23:14 <avtar> gtirloni: and it doesn\'t look like shared folders are getting a lot of love in the virtualbox project
2016-10-07T14:23:21 <gtirloni> jhernandez: cool, that seems reasonable
2016-10-07T14:24:07 * lliskovoi_ joined the channel
2016-10-07T14:24:15 <jhernandez> what I really find disturbing, is that when the universal (or linux box, can\'t remember right now) blocks my 8081 port in my host system
2016-10-07T14:24:23 <gtirloni> avtar: agreed. virtualbox is not getting a lot of love but right now it\'s the only virtualization product that works across all 3 platforms we try to support (linux/osx/windows). I wish we had the bandwidth to have Hyper-V on windows, KVM on Linux and xhyve on OSX :~(
2016-10-07T14:24:36 * alanharn_ joined the channel
2016-10-07T14:25:17 * michelled1 joined the channel
2016-10-07T14:26:41 <gtirloni> jhernandez: yeah, that\'s less the ideal. the workaround is to provide an environment varialbe, or an Ansible parameter or tweak the Vagrantfile -- https://github.com/GPII/linux/blob/master/Vagrantfile#L17
2016-10-07T14:28:52 <stegru> jhernandez: is that due to the port forwarding of the vm? I just use a bridge adapter and access the vm directly
2016-10-07T14:29:11 * michelled joined the channel
2016-10-07T14:29:14 * lliskovoi_ joined the channel
2016-10-07T14:29:20 <gtirloni> re: the split node_modules, we at an impasse. npm2 + symlinks won\'t work with shared folders, npm3 without symlinsk won\'t work on OSX/Linux hosts (stack issue), npm3 with symlinks won\'t work inside shared folder on Windows hosts... Another approach would be to keep using npm2 but I read somewhere npm3 is needed for the Windows work, right?
2016-10-07T14:29:31 * clown joined the channel
2016-10-07T14:30:36 <gtirloni> I\'m in favor of moving ahead with split node_modules directory and dealing with the fallout, if any. I\'d revert my vote if we can find a real world situation that would be impacted today by this
2016-10-07T14:31:20 <gtirloni> but I don\'t do universal/fluid development on a daily basis, so my view is not as good as everybody\'s else
2016-10-07T14:31:55 <alanharn_> life-changing Chrome browser thing I just learned: ou can shift or command/control click tabs in Chrome to select and drag a number of them off into a new window in one go
2016-10-07T14:32:54 * ewbjr has quit
2016-10-07T14:33:34 * Justin_o joined the channel
2016-10-07T14:34:08 * ewbjr joined the channel
2016-10-07T14:34:13 <stegru> wow
2016-10-07T14:34:20 <Bosmon7> alanharnum - if I ever had more than one tab in a window, this would change my life :)
2016-10-07T14:34:42 <jhernandez> gtirloni: re the 8081 issue, yeah, ONLY when I remember, I change that line in the Vagrantfile :)
2016-10-07T14:35:05 <alanharnum> Bosmon7: i like to have topic-based windows with a group of tabs in each
2016-10-07T14:35:16 <alanharnum> so this is important for me :)
2016-10-07T14:37:29 <jhernandez> gtirloni: yes, windows have some problems with long path names and npm3 helps a bit since it flattens the deps inside the node_modules folder
2016-10-07T14:40:30 * simonjb joined the channel
2016-10-07T14:42:25 <jhernandez> gtirloni: my opinion about splitting node_modules? As I said before, I really don\'t care, if splitting them will cause us more problems and headaches than solutions then I wouldn\'t go for it
2016-10-07T14:42:57 <gtirloni> thanks
2016-10-07T14:44:40 <avtar> gtirloni: a possible third option that we moved away from earlier is to use vagrant\'s rsync support
2016-10-07T14:45:08 <avtar> which would address this node_modules and symlinks issue
2016-10-07T14:45:34 <avtar> https://github.com/GPII/qi-development-environments/tree/58baa7ca03373bda705df5352b026ff46c2f6b5a#requirements
2016-10-07T14:47:33 <gtirloni> I\'d be fine with that too. I only barely remember there were some issues with existing Cygwin installations that couldn\'t be changed (maybe the /etc/fstab change?)
2016-10-07T14:48:03 <Bosmon7> -1 for rsync
2016-10-07T14:48:08 <Bosmon7> +1 for putting node_modules somewhere else
2016-10-07T14:49:04 <avtar> the two issues are the cygwin /etc/fstab change and that \'vagrant rsync-auto\' needs to be used to watch for filesystem changes and sync them in a unidirectional way from the host to the guest
2016-10-07T14:50:04 <gtirloni> ok, let\'s go ahead with this and I promise to quickly revert the change (or find fixes) in case things break :)
2016-10-07T14:51:18 <gtirloni> but first, lunch!
2016-10-07T14:51:23 <gtirloni> thanks a lot for everybody\'s feedback on this
2016-10-07T14:51:40 <Bosmon7> LUNICH!
2016-10-07T15:01:20 * amatas joined the channel
2016-10-07T15:23:38 <clown> Was ist das Lunich, Bosmon7?
2016-10-07T15:25:29 <clown> Eine Stadt neben M\xc3\xbcnchen?
2016-10-07T15:27:49 <avtar> cindyli: looks like your changes work here (waiting for the vm to finish provisioning)
2016-10-07T15:28:34 <cindyli> that\'s great. thanks, avtar
2016-10-07T15:28:39 <cindyli> let me know
2016-10-07T15:29:16 <Bosmon7> Famed in NIGHT TRAIN TO LUNICH
2016-10-07T15:29:20 <avtar> npm install worked in a cmd window by default but if cygwin is being used, and for whatever reason one has git installed as a cygwin package and from chocolatey (in program files), then the one in program files needs to be first in the path https://github.com/npm/npm/issues/8309
2016-10-07T15:31:09 <Bosmon7> avtar - Aren\'t you talking about the inside of the VM?
2016-10-07T15:35:32 <avtar> Bosmon7: no, the workflow is "npm install && vagrant up && grunt tests"
2016-10-07T15:35:50 <avtar> npm install first to have a local copy of grunt available
2016-10-07T15:35:59 <Bosmon7> That seems crazy to me
2016-10-07T15:36:05 <Bosmon7> Why would we run grunt on the outside of the VM?
2016-10-07T15:36:05 <Justin_o> lliskovoi: if you have some time, could you let me know what you think of the edits i made to this test plan. https://wiki.fluidproject.org/display/fluid/Inline+Edit+QA+Test+Plan+-+Dropdown
2016-10-07T15:36:20 <Justin_o> lliskovoi: specifically for the AT section in the state tests and the validation section
2016-10-07T15:37:21 * colinclark has quit
2016-10-07T15:37:35 <avtar> Bosmon7: so that the \'tests\' grunt task can be used on the host
2016-10-07T15:38:41 <avtar> with this node_modules being located somewhere else in the vm approach the host\'s node_modules directory needs to be populated separately
2016-10-07T15:39:23 <Bosmon7> avtar - surely it always was
2016-10-07T15:39:27 <stegru> oh I\'ve never ran npm install on the host. am I missing something?
2016-10-07T15:39:38 <Bosmon7> I think we are all missing something : P
2016-10-07T15:39:51 <Bosmon7> We\'d better all club together and reassess what is happening here
2016-10-07T15:39:58 <Bosmon7> So, it was always fatal to run npm install on the host
2016-10-07T15:40:09 <Bosmon7> Since it would build a whole bunch of binaries that wouldn\'t run in the VM
2016-10-07T15:40:23 <Bosmon7> So how did we ever run this "tests" grunt task that you speak of?
2016-10-07T15:42:28 <stegru> i think if your VM is the same as the host, then npm install would be ok?
2016-10-07T15:43:08 <stegru> I\'ve ran npm install on a win-10 VM, and things still work in a win-7 and 8 VM
2016-10-07T15:43:49 <avtar> Bosmon7: this is related to the conversation we were having earlier in this channel. gio has made changes that mount the node_modules directory to a location in the vm that isn\'t being managed by virtualbox shared folders. this means the host and vm don\'t share this directory and npm3 with symlinks can be used. what this also means is that if you want to run
2016-10-07T15:43:49 <avtar> \'grunt tests\' on the host you need to run \'npm install\' whereas before the vm would have run \'npm install\' which would have made grunt in node_modules available to the host
2016-10-07T15:44:21 <Bosmon7> avtar - this doesn\'t all hang together
2016-10-07T15:44:37 <Bosmon7> I notice that we only use this "grunt tests" thing in universal, and not in windows
2016-10-07T15:44:50 <Bosmon7> Which perhaps explains why we haven\'t triggered the problem with incompatible binaries
2016-10-07T15:45:09 <avtar> yup, i\'m testing cindy\'s universal GPII-1274 branch
'

