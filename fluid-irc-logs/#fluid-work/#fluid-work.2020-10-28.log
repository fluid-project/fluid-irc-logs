2020-10-28T13:23:21  <Justin_o> cindyli: when you have a chance, could you please review this PR https://github.com/fluid-project/infusion/pull/1021
2020-10-28T13:23:44  <cindyli> sure, Justin_o
2020-10-28T13:23:51  <Justin_o> cindyli: thanks
2020-10-28T13:24:23  <cindyli> np, Justin_o, when you get a chance, could you review my PR - https://github.com/inclusive-design/covid-assessment-centres/pull/9
2020-10-28T13:24:40  <Justin_o> cindyli: I'll take a look at it right now
2020-10-28T13:24:46  <cindyli> thanks
2020-10-28T13:39:01  <Justin_o> cindyli: are you planning on releasing an npm package for the covid-assessment-centres code, or is the package.json just for pulling in dependencies?
2020-10-28T13:40:04  <cindyli> Justin_o: it's the latter. there isn't a plan to release a npm package for it
2020-10-28T13:41:11  <Justin_o> cindyli: okay, thanks
2020-10-28T14:33:31  <Justin_o> Bosmon: when was the last time you created a build or release of infusion?
2020-10-28T14:33:58  <Justin_o> I'm noticing that the `grunt buildDists` command is failing for me due to an issue with Switch styling
2020-10-28T14:38:38  <Bosmon> Justin_o - well, I created 3.0.0-dev.20201007T193943Z.440be20ec.FLUID-6145 only a couple of weeks ago
2020-10-28T14:38:46  <Bosmon> It'll be such a shame to leave here, this interface is so readable
2020-10-28T14:39:00  <Justin_o> Bosmon:  it is much less cluttered
2020-10-28T14:39:22  <Justin_o> Maybe try the IRC theme Element?
2020-10-28T14:39:27  <Bosmon> I mean, I've been using it for 22 years : P
2020-10-28T14:39:38  <Justin_o> Bosmon: :)
2020-10-28T14:39:57  <Bosmon> IRC theme Element?
2020-10-28T14:40:11  <Justin_o> Bosmon: so I'm not really sure why I'm getting failures right now, I don't see any recent changes that would seem to affect things.. could you do me a favour and try to run `grunt buildDists` and see if you get an error?
2020-10-28T14:41:37  <Justin_o> Bosmon: in Element, if you go to the All Settings > Appearance > Show advanced   there is an options called "Enable experimental, compact IRC style layout"
2020-10-28T14:41:44  <Justin_o> maybe you'll like that better, but not sure
2020-10-28T14:44:16  <Bosmon> Well, too cluttered the other way
2020-10-28T14:44:26  <Bosmon> The standard layout has too much whitespace, the IRC one has too little
2020-10-28T14:44:30  <Bosmon> But that's the least of the issues
2020-10-28T14:44:40  <Bosmon> I like the highly readable bitmap font in this interface
2020-10-28T14:45:16  <Justin_o> Bosmon: you can change the font in Element
2020-10-28T14:45:29  <Bosmon> I can, but it doesn't seem I can select a bitmap one : P
2020-10-28T14:45:53  <Justin_o> oh weird
2020-10-28T14:46:14  <Justin_o> Bosmon: any luck with running `grunt buildDists`?
2020-10-28T14:46:22  <Bosmon> Yes, it worked fine in my branch
2020-10-28T14:46:33  <Justin_o> :( so strange.. is it just me
2020-10-28T14:46:45  <Justin_o> and have you merged master recently?
2020-10-28T14:46:54  <Justin_o> Bosmon: also what version of node are you running?
2020-10-28T14:47:03  <Bosmon> I'm just trying master, that is to say, main, now : P
2020-10-28T14:48:05  <Justin_o> Bosmon: I keep mistyping it in my terminal
2020-10-28T14:48:13  <Bosmon> I merged main just a few days ago, after you renamed it from master : P
2020-10-28T14:49:35  <Bosmon> So buildDists works fine for me in main too
2020-10-28T14:49:45  <Bosmon> node 12.18.2
2020-10-28T14:52:49  <Justin_o> Bosmon: so strange.. I'll keep poking around.. I can't understand why it wouldn't work.. unless I've messed up something on my system
2020-10-28T14:56:39  <Justin_o> cindyli1: would you mind to try running `grunt buildDists` in Infusion.. wondering if there might be a macOS issue
2020-10-28T14:58:49  <cindyli1> Justin_o: there's an issue with running this command using the new grunt version. i rmb filing a jira for it
2020-10-28T14:58:52  <cindyli1> digging...
2020-10-28T14:59:49  <cindyli1> Justin_o: Bosmon: https://issues.fluidproject.org/browse/FLUID-6496
2020-10-28T14:59:55  *** cindyli1 is now known as cindyli
2020-10-28T15:04:03  <greatislander> Bosmon: what font are you trying to use?
2020-10-28T15:04:07  <greatislander> (in Element)
2020-10-28T15:04:17  <Bosmon> greatislander - one of my own : P
2020-10-28T15:04:22  <greatislander> I can set it to any font installed on my system by name
2020-10-28T15:05:02  <greatislander> https://usercontent.irccloud-cdn.com/file/zvFuXf6a/font.png
2020-10-28T15:05:11  <Bosmon> greatislander - I'd be deeply surprised if you had any bitmap fonts installed on your system : P
2020-10-28T15:05:35  <greatislander> Ah, so it's not in a format that works?
2020-10-28T15:05:37  <greatislander> I see
2020-10-28T15:05:42  <Bosmon> Well it works in other apps
2020-10-28T15:05:49  <Bosmon> Just not in this box
2020-10-28T15:05:53  <Justin_o> cindyli: thanks, looks like it was updated 7 months ago to grunt 1.1.0. I wonder why Bosmon doesn't get that issue though
2020-10-28T15:06:01  <Justin_o> maybe it's only a problem on macOS with this version of grunt
2020-10-28T15:07:37  <cindyli> maybe. Bosmon: did this command work fine before within the 7 month window?
2020-10-28T15:09:32  <Bosmon> cindyli - but it still works now
2020-10-28T15:10:15  <Justin_o> cindyli, Bosmon: I'm wondering if this is an issue only on certain platforms?
2020-10-28T15:11:06  <Justin_o> Bosmon: any chance yours is still using the older version of grunt?
2020-10-28T15:12:05  <Bosmon> Justin_o no, it is on 1.1.0
2020-10-28T15:16:16  <Justin_o> Bosmon: I just asked jhung to try as well and it also worked for him.. so it seems this isn't an issue for windows
2020-10-28T15:19:38  <cindyli> right. my bad, i didn't catch enough conversation. thought Bosmon is having problem with "grunt buildDists".
2020-10-28T15:20:03  <Justin_o> cindyli: when you file the JIRA did you happen to find a reference to the issue in a grunt ticket?
2020-10-28T15:20:21  <cindyli> Justin_o: i just ran "grunt buildDists" again. the build aborted at a different and unexpected step:
2020-10-28T15:20:22  <cindyli> Running "stylus:dist" (stylus) task
2020-10-28T15:20:22  <cindyli> Warning: Unable to write "dist/assets/src/components/switch/css/stylus/../Switch.css" file (Error code: ENOENT). Use --force to continue.
2020-10-28T15:21:08  <Justin_o> cindyli: that's what I got, but it looks the same as what you mentioned in the FLUID-6496
2020-10-28T15:21:51  <cindyli> true. still the same. :)
2020-10-28T15:23:53  <cindyli> Justin_o: no, i didn't dig into grunt tickets. at the time i hit this error, the command was fine just a couple of days ago so i know it was from recent merges
2020-10-28T15:24:59  <Justin_o> cindyli: I should apologize because I don't think I fully understood the issue when you filed this ticket. It seems like a big problem now though.. so we need to consider if we fix this by downgrading, modifying the structure so that it doesn't trigger the error, or perhaps moving off of stylus.
2020-10-28T15:25:33  <cindyli> i agree
2020-10-28T15:26:05  <Justin_o> cindyli: any preference? greatislander thoughts?
2020-10-28T15:26:54  <cindyli> the short term fix is to downgrade grunt. a more proper fix is to figure out why grunt fails at linting stylus files
2020-10-28T15:27:49  <Justin_o> cindyli: agreed.. the problem with just downgrading is that this will probably come up again
2020-10-28T15:28:04  <Justin_o> let me see if I can find out what changed between releases
2020-10-28T15:30:51  <Justin_o> cindyli: so almost nothing changed except `mkdir` https://github.com/gruntjs/grunt/compare/v1.0.2...v1.0.3
2020-10-28T15:31:12  <Justin_o> so I guess it's having trouble making the necessary intermediate paths
2020-10-28T15:31:41  <cindyli> good finding, Justin_o
2020-10-28T15:33:30  <Justin_o> cindyli: https://www.npmjs.com/package/mkdirp#implementation
2020-10-28T15:34:17  <cindyli> ah ha, seems like a quick fix
2020-10-28T15:44:17  <Justin_o> cindyli: well that's the tool they are using, so it could be related to it.. or maybe we can force some config on it
2020-10-28T15:44:29  <Justin_o> but we're also abstracted through the stylus plugin so not sure
2020-10-28T15:47:05  <cindyli> Justin_o: if it's because dirs for holding stylus converted css files are not created, is it possible to add an extra grunt step to manually create them?
2020-10-28T15:47:23  <Justin_o> we could do that too
2020-10-28T15:47:51  <Justin_o> but we don't always know that they will be included I think, in particular because this is for the switch component.. although with buildDists I guess it will always be needed
2020-10-28T15:47:56  <Justin_o> so maybe that is the easiest
2020-10-28T16:03:33  <greatislander> Sorry justin_o and cindyli, I haven't been monitoring here as closely
2020-10-28T16:04:17  <greatislander> The issue is that build is failing because of a Stylus problem?
2020-10-28T16:07:52  <Justin_o> greatislander: well not really because of stylus itself but from building the files and putting them in the dist directory
2020-10-28T16:08:49  <greatislander> Right
2020-10-28T16:09:08  <greatislander> So the issue is that Stylus can't write the file because the directories don't exist yet?
2020-10-28T16:10:33  <Justin_o> I think so.. although this worked in older versions of grunt so I think something broke there
2020-10-28T16:14:00  <greatislander> cindyli Justin_o do you know when this stopped working?
2020-10-28T16:14:16  <cindyli> when grunt is upgrade away from 1.0.2
2020-10-28T16:14:48  <Justin_o> greatislander: these are the changes in grunt https://github.com/gruntjs/grunt/compare/v1.0.2...v1.0.3
2020-10-28T16:17:28  <cindyli> greatislander: regarding your PR - https://github.com/fluid-project/infusion/pull/1020, my test results is, the focus style is great in chrome and safari, but not firefox
2020-10-28T16:18:12  <cindyli> moreover, with firefox, the focus styling for selected contrast theme is invisible
2020-10-28T16:18:25  <cindyli> can you give a try? thanks
2020-10-28T16:20:09  <greatislander> It is working for me!
2020-10-28T16:20:12  <greatislander> I'm puzzled
2020-10-28T16:22:35  <cindyli> greatislander: do you wanna have a quick call so i can share my screen?
2020-10-28T16:22:42  <greatislander> sure
2020-10-28T16:22:59  <cindyli> not sure if stand up room is in use. checking...
2020-10-28T16:23:23  <greatislander> general room is free
2020-10-28T16:23:28  <cindyli> coming
2020-10-28T16:31:20  *** clown[m] is now known as clown_afk[m]
2020-10-28T16:32:35  <cindyli> greatislander: i forgot to ask just now, did you figure out the problem with the service work caching issue?
2020-10-28T16:32:45  <greatislander> not really
2020-10-28T16:32:53  <greatislander> I just keep unregistering the service worker
2020-10-28T16:33:00  <cindyli> cool. good to know
2020-10-28T16:49:35  <greatislander> cindyli: is there a JIRA for that Grunt issue you found?
2020-10-28T16:54:33  <cindyli> greatislander: here it is - https://issues.fluidproject.org/browse/FLUID-6496
2020-10-28T17:43:30  *** clown_afk[m] is now known as clown[m]
2020-10-28T18:19:00  <Justin_o> greatislander: I'm just getting back to looking at the grunt issue. Is that something you started looking into yet?
2020-10-28T18:20:09  <greatislander> justin_o yes, I'm working on it. Can you assign that JIRA to me?
2020-10-28T18:20:30  <greatislander> Never mind, I did :)
2020-10-28T18:21:21  <Justin_o> greatislander: okay, I'll leave that one with you for now.. I'm holding off on looking at your other PRs as I can't properly test them all till this is resolved and don't want to accidentally add in any other conflicts or conflations.
2020-10-28T18:24:47  <Justin_o> greatislander: also just replied to the eleventy-plugin-fluid PR. I had forgotten to hit enter earlier.
2020-10-28T18:30:17  <greatislander> So, Justin_o, I think the issue here is that grunt-contrib-stylus appears to be effectively abandoned
2020-10-28T18:31:13  <Justin_o> well it was published 5 years ago ;)
2020-10-28T18:31:18  <greatislander> yeah…
2020-10-28T18:31:38  <Justin_o> it's a bit unfortunately because that's package from grunt itself
2020-10-28T18:31:39  <greatislander> So I think the change in Grunt >= 1.0.3 caused it to stop working
2020-10-28T18:31:50  <greatislander> I think that's reflective of the Stylus project, to be honesdt
2020-10-28T18:31:52  <greatislander> I think that's reflective of the Stylus project, to be honest
2020-10-28T18:31:55  <Justin_o> greatislander: seems like they didn't bother to update it
2020-10-28T18:32:02  <greatislander> It seems to have really stagnated in the last few years
2020-10-28T18:32:25  <Justin_o> well stylus was published 3 months ago, but not sure what the changes were
2020-10-28T18:32:52  <Justin_o> greatislander: https://github.com/stylus/stylus/releases
2020-10-28T18:32:59  <greatislander> yeah
2020-10-28T18:33:01  <Justin_o> interestingly they have a fix related to mkdir
2020-10-28T18:33:05  <greatislander> I've been looking at it
2020-10-28T18:33:08  <greatislander> interesting!
2020-10-28T18:34:02  <Justin_o> but they also have two more recent tags without release attached
2020-10-28T18:35:32  <Justin_o> greatislander: anyways, I wonder if we should just do the easy fix here and pre-create the directory paths ourselves. Then we can consider if now is the time to drop stylus in another PR.. unless it's easy enough to just do that right now. We could also offer up a fix back to grunt-contrib-stylus
2020-10-28T18:35:52  <greatislander> I'm going to see if I can fix grunt-contrib-stylus
2020-10-28T18:36:05  <greatislander> If it seems to complicated I'll try a different approach
2020-10-28T18:36:12  <Justin_o> greatislander: thanks
2020-10-28T18:48:20  <greatislander> re: Grunt
2020-10-28T18:48:32  <greatislander> https://usercontent.irccloud-cdn.com/file/waUFKVg9/Screen%20Shot%202020-10-28%20at%203.48.13%20PM.png
2020-10-28T18:48:33  <greatislander> :/
2020-10-28T18:49:11  <Justin_o> especially the plugins eh
2020-10-28T18:51:00  <greatislander> lol
2020-10-28T18:51:19  <greatislander> the next comment: https://github.com/gruntjs/grunt/issues/1700#issuecomment-582737281
2020-10-28T18:52:39  <Justin_o> haha fortunately they've fixed that issue now. I ran into that not too long ago though
2020-10-28T18:55:04  <greatislander> So, I think short term the best bet is for us to migrate to the (somewhat better maintained) grunt-contrib-sass plugin and do what's needed to convert the Stylus source in Infusion to Sass
2020-10-28T18:55:53  <greatislander> I hate to say it, Justin_o, but I think we should probably discuss the long-term viability of Grunt for our projects.
2020-10-28T18:57:51  <Justin_o> it is sad, I liked grunt a lot. It does seem like things are moving more toward using npm scripts combined with node modules.
2020-10-28T18:58:16  <greatislander> :(
2020-10-28T18:58:51  <Justin_o> For some of the projects it's just about getting fluid-grunt-lint-all converted to run without grunt, but for infusion it's going to be a big task that will probably involve converting the layout of infusion itself
2020-10-28T18:58:53  <Justin_o> Bosmon: ^
2020-10-28T18:59:25  <Bosmon> greatislander - yes, I've been worrying about the long-term viability of grunt for a long time : P
2020-10-28T18:59:52  <Bosmon> The way it loads its plugins is offensively obstructive, and it introduces such a vast swathe of junk dependencies into every project
2020-10-28T19:00:31  <Bosmon> I'd hope we can move Infusion off grunt without having to change its layout too much ....
2020-10-28T19:00:37  <Bosmon> It would be awkward to combine those two tasks
2020-10-28T19:00:53  <greatislander> I don't think they need to be combined
2020-10-28T19:01:32  <greatislander> Although, changing the build process would be a good opportunity to tackle https://issues.fluidproject.org/browse/FLUID-6359
2020-10-28T19:01:36  <Justin_o> Bosmon, greatislander: I think the issue is custom builds. We wrote a grunt module for that
2020-10-28T19:01:54  <Bosmon> Justin_o - sure, but we could easily unpackage the code from that module into ordinary code
2020-10-28T19:01:55  <greatislander> Justin_o I think there are lots of tools that could help with that nowadays
2020-10-28T19:02:01  <Bosmon> It would make a lot more sense that way too : P
2020-10-28T19:02:02  <greatislander> +1
2020-10-28T19:02:53  <Justin_o> Bosmon: but I think it might make more sense to just get to a structure that we like than to re-create that package for the current structure and then do that process again when we re-jig the layout
2020-10-28T19:02:58  <Justin_o> but maybe it isn't that hard
2020-10-28T19:03:09  <Bosmon> Although perhaps it *would* be an opportunity to go partway to the goal of modularising Infusion a bit better - we should kick around some ideas for whether we can replace our weird "dependency.json" files with something resembling standard, but miniature, package.json files
2020-10-28T19:03:16  <greatislander> Justin_o Bosmon if you're okay with this— rather than working on trying to patch grunt-contrib-stylus and hope the patch is accepted— I'm going to tackle https://issues.fluidproject.org/browse/FLUID-6496 by migrating Stylus to Sass
2020-10-28T19:03:18  <Bosmon> Since that is sort of what I will be up to when the new renderer arrives
2020-10-28T19:03:41  <Bosmon> Basically "new Infusion renderer modules" will just be standard node modules with package.json files including some extra metadata
2020-10-28T19:03:48  <greatislander> Bosmon are you thinking along the lines of a monorepo?
2020-10-28T19:03:58  <Bosmon> greatislander - exactly along the lines of a monorepo
2020-10-28T19:04:15  <greatislander> cool. I worked with Lerna a bit at my old job.
2020-10-28T19:04:28  <Bosmon> That will be interesting to hear/talk about
2020-10-28T19:04:42  <Bosmon> We sort of semi-evaluated Lerna back in the days we considered this interminable task
2020-10-28T19:04:53  <Justin_o> greatislander: I don't have any particular objection for migrating off of stylus to sass. But it would be good to see what the conversion looks like. Also if we can just drop the css preprocessor completely and still have easily maintainable styling for Infusion that might be the way to go
2020-10-28T19:05:14  <Bosmon> I am right now inclining to some very lightweight thing along the lines of what the existing grunt modulefiles plugin does, only with some reformed metadata, rather than any more wholesale thing involving ambitious tooling
2020-10-28T19:05:23  <greatislander> at the time it was quite frustrating because publishing all the packages would run longer than the 30 seconds that my NPM OTP was valid, Bosmon
2020-10-28T19:05:31  <Bosmon> But it would be interesting to see how many birds we could knock off with this stone without creating too much upheaval
2020-10-28T19:05:32  <Bosmon> Right
2020-10-28T19:05:52  <greatislander> But I think that's been addressed now
2020-10-28T19:06:06  <Bosmon> As I see it, this change would be mainly cosmetic for now
2020-10-28T19:06:15  <Bosmon> But ease the path to future migration to a genuine monorepo later
2020-10-28T19:06:20  <greatislander> Justin_o I think using a preprocessor still makes sense if just for nesting
2020-10-28T19:06:57  <Justin_o> greatislander: if it still makes sense, that's fine
2020-10-28T19:07:10  <Bosmon> In case you're interested, the most recent notes of a 4-year-old discussion, itself building on a 6-year-old discussion, are here : P
2020-10-28T19:07:11  <Bosmon> https://wiki.fluidproject.org/display/fluid/Notes+on+Modularisation+of+Infusion
2020-10-28T19:07:25  <greatislander> ah, thanks, Bosmon, I'll check that out
2020-10-28T19:07:36  <Bosmon> Well, check it out only lightly : P
2020-10-28T19:07:43  <Bosmon> A detailed look might well drive you insane
2020-10-28T19:07:46  <greatislander> hah!
2020-10-28T19:07:52  <Justin_o> "bower" is a particularly interesting current environment
2020-10-28T19:07:56  <Justin_o> this is an old docu
2020-10-28T19:07:57  <Bosmon> Given this discussion started in the days when "bower" was still a "thing"
2020-10-28T19:07:59  <greatislander> BOWER
2020-10-28T19:08:03  <Bosmon> snap
2020-10-28T19:08:05  <greatislander> I haven't heard that name in years…
2020-10-28T19:08:43  <Bosmon> Interestingly the "SOME GIZMOS WE COULD IMPLEMENT TO FIND A WAY OUT" first item is sort of what I have implemented
2020-10-28T19:08:51  <Bosmon> So good to know this discussion didn't go totally for nothing : P
2020-10-28T19:09:26  <Bosmon> But the c) item highlights the kind of totally nightmarish problems that Grunt was causing for us with 3rd-party projects
2020-10-28T19:10:00  <Bosmon> b) has notes on a form of "Lerna lite"
2020-10-28T19:10:30  <Justin_o> I think we've moved away from c) by building multiple distributions that are contained within the dist directory
2020-10-28T19:10:42  <Justin_o> still lots of copying though
2020-10-28T19:10:58  <Bosmon> Justin_o - I think that is actually what c) says, the notes look like they got a bit mangled from cut and pasting
2020-10-28T19:11:10  <Bosmon> I think what I was referring to was "iii") which got detached from the list above
2020-10-28T19:11:44  <Bosmon> I suspect I cut n pasted this badly from a contemporary piratepad
2020-10-28T19:15:48  <Justin_o> Bosmon: okay.. I think we had a case before where the grunt builds were being run from the node_modules directory when it was installed as a dependency
2020-10-28T23:14:03  <Bosmon> I hate grunt so much
2020-10-28T23:14:13  <Bosmon> I would be so glad if we could be rid of it and its 125 dependencies : P
2020-10-28T23:15:45  <Bosmon> Sadly nyc brings in a further 125
2020-10-28T23:15:55  <Bosmon> No, 175
